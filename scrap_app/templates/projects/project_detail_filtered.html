<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
  <title>Project Details</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">

  <meta content="width=device-width; initial-scale=1.0; maximum-scale=1.0;   user-scalable=0;" name="viewport">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="//cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css">

  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.4/jquery-confirm.min.js" integrity="sha512-zP5W8791v1A6FToy+viyoyUUyjCzx+4K8XZCKzW28AnCoepPNIXecxh9mvGuy3Rt78OzEsU+VCvcObwAMvBAww==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="//cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/notify/0.4.2/notify.min.js" integrity="sha512-efUTj3HdSPwWJ9gjfGR71X9cvsrthIA78/Fvd/IN+fttQVy7XWkOAXb295j8B3cmm/kFKVxjiNYzKw9IQJHIuQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.blockUI/2.70/jquery.blockUI.min.js" integrity="sha512-eYSzo+20ajZMRsjxB6L7eyqo5kuXuS2+wEbbOkpaur+sA2shQameiJiWEzCIDwJqaB0a4a6tCuEvCOBHUg3Skg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script> $(document).ready( function () {
    $('#myTable').DataTable();
  } );</script>
</head>

<table class="table table-hover">
    <thead>
      <tr>
        <th>Sr no.</th>
        <th>Actual Developer Name</th>
        <th>Screen Developer Name</th>
        <th>Project Name</th>
        <th>Project Hours</th>
        <th>Expected Cycle Hours</th>
<!--        <th>Project End Date</th>-->
<!--        <th>Expected Hours</th>-->
        <th>Email</th>
<!--          <th>Daily Hours</th>-->

      </tr>
    </thead>
    <tbody>
      {% for project in project_list %}
         {% if project.cycle_hour_diff <= 28800 %}
      <tr bgcolor="yellowgreen">
        {% elif project.cycle_hour_diff > 28800 and project.cycle_hour_diff <= 57600 %}
      <tr bgcolor="yellow">
        {% else %}
      <tr bgcolor="salmon">
        {% endif %}
        <td>{{ forloop.counter }}</td>
        <td>{{project.actual_developer.first_name}} {{project.actual_developer.last_name}}</td>
        <td>{{project.developer_name}}</td>
        <td>{{project.projects_name}}</td>
<!--        <td>{{employe.project_start_date}}</td>-->
<!--        <td>{{employe.project_end_date}}</td>-->
        <td>{{project.project_hours}}</td>
          <td>{{project.expected_cycle_hours}}</td>
<!--        <td>{{employe.project_left_hrs}}</td>-->
        <td>{{project.developer_email}}</td>
        <td><a href="#" onclick="confirmationBox('{{project.id}}');">Delete</a></td>
         <td><a href="/updateproject/{{project.id}}" >Update</a></td>
      </tr>





      {% endfor %}

    </tbody>
  </table>


<script type="text/javascript">
  $(document).ready(function() {
         $('#cycles').change(function(){
             var cycles = $('#cycles').val();
             var developer = $('#developer').val();
             var project = $('#project').val();
             if (cycles != 0) {
             sortingRecentFiles(cycles,project, developer)
             }
         });
          $('#developer').change(function(){
             var developer = $('#developer').val();
             var cycles = $('#cycles').val();
             var project = $('#project').val();
             if (developer != 0) {
             sortingRecentFiles(cycles,project, developer)
             }
         }); $('#project').change(function(){
             var project = $('#project').val();
             var developer = $('#developer').val();
             var cycles = $('#cycles').val();
             if (project != 0) {
             sortingRecentFiles(cycles,project, developer)
             }
         });
         $('#actual_developer').change(function(){
             var developer = $('#developer').val();
             var actual_developer = $('#actual_developer').val();
             var cycles = $('#cycles').val();
             var project = $('#project').val();
             if (actual_developer != 0) {
             sortingRecentFiles(cycles,project, developer, actual_developer)
             }
         });
      });

      function sortingRecentFiles(billing, project, developer, actual_developer){
         postdata = {billing:billing, project:project, developer:developer, actual_developer:actual_developer, 'csrfmiddlewaretoken': "{{ csrf_token }}"}
         $.ajax({
                url: "/dropdown/",
                type: "POST",
                data: postdata,
                success: function(data) {
<!--                  $.unblockUI()-->
<!--                  if (data.status_code == 200){-->
<!--                  }-->
<!--                  else{-->
<!--                  }-->
                }
            });
            }
    function confirmationBox(id){
    var retVal = confirm("Do you really want to delete it?");
               if( retVal == true ) {
               Delete_project(id)

                  return true;
               } else {

                  return false;
               }
             }

      function Delete_project(id){
         postdata = {id:id, 'csrfmiddlewaretoken': "{{ csrf_token }}"}
         $.ajax({
                url: "/deleteproject/",
                type: "POST",
                data: postdata,
                success: function(data) {

                  if (data.status_code == 200){
                  $.notify(data.status_message,{'globalPosition':'top centre','className': 'success', autoHideDelay: 3000})
                      setInterval(function(){
                      window.location.reload();
                  },1500);
                    }
                    else{
                      $.notify(data.status_message,{'globalPosition':'top centre','className': 'error', autoHideDelay: 3000})
                    }
                }
            });
            }

function update_project(id){
         postdata = {id:id, 'csrfmiddlewaretoken': "{{ csrf_token }}"}
         $.ajax({
                url: "/updateproject/",
                type: "POST",
                data: postdata,
                success: function(data) {


                }
            });
            }


$("#refresh").click(function(){
  $.blockUI({
		css: {
			border: '5px solid #3c8dbc',
			borderRadius: '5px',
			padding: '20px 0'

		},
        message: $('#domMessage')
    });

   $.ajax({
    type: "GET",
    url: "/project_detail_refresh/",
    success: function(data){
       console.log(data);
       $.unblockUI();
       window.location.reload();
    }
  });
});

</script>

</html>
